# RunSight - 智能眼镜运动数据显示应用

## 项目简介

RunSight 是一款专为 Rokid Glasses 智能眼镜开发的运动数据显示应用。通过蓝牙连接佳明手表，实时显示跑步时的关键运动数据，包括心率、配速、运动时间和累计距离。

## 核心特性

### ✅ 已实现功能

- **🔍 蓝牙设备扫描**: 自动扫描并识别佳明手表设备
- **📱 设备连接管理**: 稳定的蓝牙GATT连接，支持断线重连
- **📊 FIT数据解析**: 完整的佳明FIT协议数据解析支持
- **💚 绿色单色UI**: 专为Rokid Glasses 480×640绿色显示优化
- **⚡ 电量优化**: 1Hz刷新频率，最小化电量消耗
- **🎮 触控板交互**: 支持滑动选择、单击确认、双击返回

### 📊 实时数据显示

- **❤️ 心率监测**: 实时BPM显示，支持心率区间颜色提示
- **⏱️ 配速追踪**: 分钟/公里格式的实时配速
- **🕐 运动时间**: 精确的运动时长计时
- **📏 累计距离**: 公里单位的距离统计

### 🎨 设计规范

- **屏幕适配**: 480×640分辨率，最佳显示区域480×400
- **颜色主题**: 绿色#40FF5E为主色调，纯黑背景
- **无渐变设计**: 符合单色显示要求
- **简洁界面**: 专为跑步场景优化的信息布局

## 技术架构

### 核心技术栈

- **开发语言**: Kotlin
- **UI框架**: Jetpack Compose + XR Compose
- **架构模式**: MVVM + Repository Pattern
- **蓝牙通信**: Android Bluetooth LE API
- **数据解析**: Garmin FIT SDK (Java版本)
- **状态管理**: Kotlin Flow + StateFlow

### 项目结构

```
com.mouzhi.runsight/
├── bluetooth/              # 蓝牙管理模块
│   └── BluetoothManager    # 设备扫描和连接管理
├── data/                   # 数据层
│   ├── models/            # 数据模型
│   └── repository/        # 数据仓库
├── fit/                   # FIT数据解析
│   └── FitDataParser      # FIT协议解析器
├── ui/                    # UI层
│   ├── components/        # 通用UI组件
│   ├── screens/          # 界面组件
│   ├── theme/            # 主题和样式
│   └── viewmodel/        # ViewModel
└── MainActivity          # 主活动
```

## 开发进度

### ✅ 第一阶段：基础框架 (已完成)
- [x] 项目结构搭建
- [x] FIT SDK集成
- [x] 蓝牙权限配置
- [x] 绿色主题实现

### ✅ 第二阶段：核心功能 (已完成)
- [x] 蓝牙设备扫描和连接
- [x] FIT数据解析和处理
- [x] 运动数据显示界面
- [x] 设备选择界面

### ✅ 第三阶段：交互优化 (已完成)
- [x] 触控板交互逻辑
- [x] 1Hz刷新率控制
- [x] 连接状态管理
- [x] 错误处理机制

## 使用说明

### 设备要求

- **智能眼镜**: Rokid Glasses (高通AR1 SoC)
- **运动手表**: 佳明系列手表 (支持蓝牙数据广播)
- **Android版本**: API 34+ (Android 14)

### 操作指南

#### 设备连接
1. 启动应用进入扫描界面
2. 在佳明手表上开启运动模式
3. 点击"开始扫描"搜索附近设备
4. 使用触控板左右滑动选择设备
5. 触控板单击确认连接

#### 触控板操作
- **左右滑动**: 选择设备/导航
- **单击**: 确认选择/连接
- **双击**: 返回上级/断开连接

#### 数据显示
- 连接成功后自动切换到数据显示界面
- 实时显示心率、配速、时间、距离
- 绿色界面适配单色显示
- 1Hz刷新频率节省电量

## 开发环境

### 必需工具
- Android Studio (最新版本)
- Kotlin 2.0.21+
- Android Gradle Plugin 8.13.0
- JDK 11+

### 依赖库
- Jetpack Compose BOM 2025.07.00
- AndroidX XR Compose 1.0.0-alpha05
- Rokid CXR-S SDK 1.0-20250519.061355-45
- Garmin FIT SDK (Java版本)

### 构建步骤

1. **克隆项目**
   ```bash
   git clone <repository-url>
   cd RunSight
   ```

2. **配置环境**
   - 确保安装JDK 11+
   - 配置Android SDK
   - 设置JAVA_HOME环境变量

3. **构建项目**
   ```bash
   ./gradlew build
   ```

4. **安装到设备**
   ```bash
   ./gradlew installDebug
   ```

## 技术特点

### 蓝牙连接优化
- 智能设备识别和过滤
- 连接状态实时监控
- 自动重连机制
- 信号强度显示

### FIT数据处理
- 完整的FIT协议支持
- 实时数据解析
- 多种消息类型处理
- 数据有效性验证

### UI性能优化
- 1Hz刷新率控制
- 状态驱动的UI更新
- 内存使用优化
- 流畅的动画效果

### 电量管理
- 最小化后台处理
- 智能数据更新策略
- 低功耗蓝牙使用
- 屏幕刷新率控制

## 未来规划

### 功能扩展
- [ ] 多种运动模式支持
- [ ] 历史数据记录
- [ ] 个人最佳记录
- [ ] 语音提醒功能

### 性能优化
- [ ] 更精确的电量控制
- [ ] 网络数据同步
- [ ] 离线数据存储
- [ ] 更多设备兼容性

## 许可证

本项目采用 MIT 许可证 - 详见 [LICENSE](LICENSE) 文件

## 贡献指南

欢迎提交 Issue 和 Pull Request 来改进项目。

## 联系方式

如有问题或建议，请通过以下方式联系：
- 项目Issues: [GitHub Issues](https://github.com/your-repo/issues)
- 邮箱: your-email@example.com

---

**RunSight** - 让跑步数据触手可及 🏃‍♂️💚# Runsight
